!function(e,a,o){var c,i,r=[];e.AcfFieldGroupControl=e.Control.extend({preview_context:{type:null,id:null},initialize:function(n,t){var i;i=t||{},e.Control.prototype.initialize.call(this,n,i)},set_preview_context:function(n){return this.preview_context=n,this},ready:function(){var i=this;this.setting();0<=["post","term","user"].indexOf(i.params.storage_type)&&e.bind("acf-customize-context-changed",function(n){n.type===i.params.storage_type?i.set_preview_context(n).load_form():i.unload_form()}),this.$wrapper=i.container.find(".acf-fields").first(),acf.do_action("append",i.container),i.load_form(),i.container.on("change",".acf-field",function(n){var t=i.container.find(".acf-field :input[name]");acf.validation.errors=[],t.each(function(){this.checkValidity()}),acf.validation.busy=!1,a((c=i).container).data("acf",null),acf.validation.fetch({form:i.container,lock:!1,success:function(n){}})}),e.Control.prototype.ready.apply(i,arguments)},load_form:function(){var n,t,i,e,a=this;n=wp.ajax.send("load_customizer_field_groups_"+a.id,{data:{wp_customize:"on",section_id:a.id,acf_customize_context:JSON.stringify(a.preview_context),_nonce:o.load_field_group_nonce}}),t=n,i=function(n){a.$wrapper.html(n.html),a.init_fields()},e={idx:r.length,request:t,done:i,finished:!1,scope:null,arguments:null},r.push(e),t.done(function(){var n;for(e.finished=!0,e.self=this,e.arguments=arguments;r.length&&r[0].finished;)(n=r.shift()).done.apply(n.self,n.arguments)}),n.fail(function(n){console.log(" - load field group failure")}),n.always(function(){n=null})},unload_form:function(){this.$wrapper.html("")},init_fields:function(){var n=this;n.$fields=n.container.find(".acf-fields > .acf-field"),setTimeout(function(){acf.doAction("ready",n.$wrapper),acf.doAction("prepare")},1)},updateValues:function(){var n,t=this.container.find(".acf-field :input");t.each(function(){var n=a(this).attr("name");n&&(a(this).data("prev-name",n),a(this).attr("name",n.replace(/\[([0-9]+)\]/g,"[_$1]")))}),n=t.serializeJSON({useIntKeysAsArrayIndex:!1}),t.each(function(){a(this).attr("name",a(this).data("prev-name")),a(this).data("prev-name",null)}),this.setting.set(function i(e){return a.isPlainObject(e)&&(Object.keys(e).join("").match(/^([0-9_]+)$/)&&(e=Object.values(e)),a.each(e,function(n,t){e[n]=i(t)})),e}(n[this.id]))}}),acf.add_action("validation_success",function(n){c.updateValues()}),acf.add_action("validation_failure",function(n){c.container.find("> .acf-error-message").remove()}),acf.add_action("invalid",function(n){acf.validation.busy=!0}),e.bind("ready",function(){e.previewer.bind("acf-customize-context",function(n){var t;t=i,JSON.stringify(n)!=JSON.stringify(t)&&e.trigger("acf-customize-context-changed",n),i=n}),e.previewer.bind("focus-control-for-setting",function(n){})}),e.bind("save-request-params",function(n){_.extend(n,{acf_customize_context:JSON.stringify(i)})}),e.controlConstructor.acf_customizer=e.AcfFieldGroupControl,e.bind("changeset-error",function(){})}(wp.customize,jQuery,acf_fieldgroup_control);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbWl6ZS1hY2YtZmllbGRncm91cC1jb250cm9sLmpzIl0sIm5hbWVzIjpbImFwaSIsIiQiLCJvcHRpb25zIiwiY3VycmVudF9jb250cm9sIiwiYWNmX2N1c3RvbWl6ZV9jb250ZXh0IiwicXVldWUiLCJBY2ZGaWVsZEdyb3VwQ29udHJvbCIsIkNvbnRyb2wiLCJleHRlbmQiLCJwcmV2aWV3X2NvbnRleHQiLCJ0eXBlIiwiaWQiLCJpbml0aWFsaXplIiwib3B0IiwiYXJncyIsInByb3RvdHlwZSIsImNhbGwiLCJ0aGlzIiwic2V0X3ByZXZpZXdfY29udGV4dCIsImNvbnRleHQiLCJyZWFkeSIsImNvbnRyb2wiLCJzZXR0aW5nIiwiaW5kZXhPZiIsInBhcmFtcyIsInN0b3JhZ2VfdHlwZSIsImJpbmQiLCJsb2FkX2Zvcm0iLCJ1bmxvYWRfZm9ybSIsIiR3cmFwcGVyIiwiY29udGFpbmVyIiwiZmluZCIsImZpcnN0IiwiYWNmIiwiZG9fYWN0aW9uIiwib24iLCJlIiwiJGlucHV0cyIsInZhbGlkYXRpb24iLCJlcnJvcnMiLCJlYWNoIiwiY2hlY2tWYWxpZGl0eSIsImJ1c3kiLCJkYXRhIiwiZmV0Y2giLCJmb3JtIiwibG9jayIsInN1Y2Nlc3MiLCIkZm9ybSIsImFwcGx5IiwiYXJndW1lbnRzIiwicmVxdWVzdCIsImRvbmUiLCJpdGVtIiwid3AiLCJhamF4Iiwic2VuZCIsIndwX2N1c3RvbWl6ZSIsInNlY3Rpb25faWQiLCJKU09OIiwic3RyaW5naWZ5IiwiX25vbmNlIiwibG9hZF9maWVsZF9ncm91cF9ub25jZSIsInJlc3BvbnNlIiwiaHRtbCIsImluaXRfZmllbGRzIiwiaWR4IiwibGVuZ3RoIiwiZmluaXNoZWQiLCJzY29wZSIsInB1c2giLCJpdCIsInNlbGYiLCJzaGlmdCIsImZhaWwiLCJjb25zb2xlIiwibG9nIiwiYWx3YXlzIiwiJGZpZWxkcyIsInNldFRpbWVvdXQiLCJkb0FjdGlvbiIsInVwZGF0ZVZhbHVlcyIsInZhbHVlIiwibmFtZSIsImF0dHIiLCJyZXBsYWNlIiwic2VyaWFsaXplSlNPTiIsInVzZUludEtleXNBc0FycmF5SW5kZXgiLCJzZXQiLCJmaXhOdW1LZXlzIiwib2JqIiwiaXNQbGFpbk9iamVjdCIsIk9iamVjdCIsImtleXMiLCJqb2luIiwibWF0Y2giLCJ2YWx1ZXMiLCJpIiwiZWwiLCJhZGRfYWN0aW9uIiwicmVtb3ZlIiwiJGlucHV0IiwicHJldmlld2VyIiwibmV3X3ZhbCIsInByZXZfdmFsIiwidHJpZ2dlciIsInNldHRpbmdJZCIsInF1ZXJ5IiwiXyIsImNvbnRyb2xDb25zdHJ1Y3RvciIsImN1c3RvbWl6ZSIsImpRdWVyeSIsImFjZl9maWVsZGdyb3VwX2NvbnRyb2wiXSwibWFwcGluZ3MiOiJDQUNBLFNBQVdBLEVBQUtDLEVBQUdDLEdBR2xCLElBQUlDLEVBQ0hDLEVBQ0FDLEVBQVEsR0FzQlRMLEVBQUlNLHFCQUF1Qk4sRUFBSU8sUUFBUUMsT0FBTyxDQUM3Q0MsZ0JBQWlCLENBQ2hCQyxLQUFNLEtBQ05DLEdBQUksTUFFTEMsV0FBWSxTQUFVRCxFQUFJRSxHQUN6QixJQUFvQkMsRUFFWEEsRUFBT0QsR0FBTyxHQUV2QmIsRUFBSU8sUUFBUVEsVUFBVUgsV0FBV0ksS0FKbkJDLEtBSWtDTixFQUFJRyxJQUdyREksb0JBQXFCLFNBQVNDLEdBRTdCLE9BREFGLEtBQUtSLGdCQUFrQlUsRUFDaEJGLE1BRVJHLE1BQU8sV0FDTixJQUFJQyxFQUFVSixLQUNGQSxLQUFLSyxVQUVaLEdBQUssQ0FBQyxPQUFPLE9BQU8sUUFBUUMsUUFBU0YsRUFBUUcsT0FBT0MsZUFFeER6QixFQUFJMEIsS0FBTSxnQ0FBaUMsU0FBVVAsR0FFL0NBLEVBQVFULE9BQVNXLEVBQVFHLE9BQU9DLGFBQ3BDSixFQUNFSCxvQkFBcUJDLEdBQ3JCUSxZQUVGTixFQUFRTyxnQkFNWFgsS0FBS1ksU0FBV1IsRUFBUVMsVUFBVUMsS0FBSyxlQUFlQyxRQUN0REMsSUFBSUMsVUFBVyxTQUFVYixFQUFRUyxXQUVqQ1QsRUFBUU0sWUFFUk4sRUFBUVMs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QUFxQixTQUFTL0QsR0FFNUNqQyxFQUFnQjJCLFVBQVVDLEtBQUssd0JBQXdCcUUsV0FFeERuRSxJQUFJa0UsV0FBVyxVQUFXLFNBQVNFLEdBQ2xDcEUsSUFBSUssV0FBV0ksTUFBTyxJQUt2QjFDLEVBQUkwQixLQUFLLFFBQVEsV0FDaEIxQixFQUFJc0csVUFBVTVFLEtBQU0sd0JBQXlCLFNBQVU2RSxHQUN0RCxJQUFJQyxFQUVKQSxFQUFXcEcsRUFDTnVELEtBQUtDLFVBQVUyQyxJQUFZNUMsS0FBS0MsVUFBVTRDLElBQzlDeEcsRUFBSXlHLFFBQVMsZ0NBQWlDRixHQUUvQ25HLEVBQXdCbUcsSUFHekJ2RyxFQUFJc0csVUFBVTVFLEtBQU0sNEJBQTZCLFNBQVVnRixRQU81RDFHLEVBQUkwQixLQUFNLHNCQUF1QixTQUFTaUYsR0FDekNDLEVBQUVwRyxPQUFRbUcsRUFBTyxDQUFDdkcsc0JBQTBCdUQsS0FBS0MsVUFBV3hELE9BSTVESixFQUFJNkcsbUJBQW1DLGVBQUk3RyxFQUFJTSxxQkFFaEROLEVBQUkwQixLQUFLLGtCQUFtQixjQXpPN0IsQ0ErT0k0QixHQUFHd0QsVUFBV0MsT0FBUUMiLCJmaWxlIjoiY3VzdG9taXplLWFjZi1maWVsZGdyb3VwLWNvbnRyb2wubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG4oZnVuY3Rpb24oIGFwaSwgJCwgb3B0aW9ucyApIHtcblxuXHQvLyBzdG9yZSBmb3IgYWNmJ3Mgc3RhdGljIHZhbGlkYXRpb24gY2FsbGJhY2tzXG5cdHZhciBjdXJyZW50X2NvbnRyb2wsXG5cdFx0YWNmX2N1c3RvbWl6ZV9jb250ZXh0LFxuXHRcdHF1ZXVlID0gW107XG5cblx0Ly8gbWFrZSBzdXJlIGZpZWxkcyBnZXQgaW5pdGVkIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgZG9tXG5cdGZ1bmN0aW9uIGVucXVldWUocmVxdWVzdCxkb25lKSB7XG5cdFx0dmFyIGlkeCA9IHF1ZXVlLmxlbmd0aCxcblx0XHRcdGl0ZW0gPSB7IGlkeDppZHgsIHJlcXVlc3Q6cmVxdWVzdCwgZG9uZTogZG9uZSwgZmluaXNoZWQ6ZmFsc2UsIHNjb3BlOm51bGwsIGFyZ3VtZW50czpudWxsIH07XG5cblx0XHRxdWV1ZS5wdXNoKCBpdGVtICk7XG5cblx0XHRyZXF1ZXN0LmRvbmUoIGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgaXQ7XG5cdFx0XHRpdGVtLmZpbmlzaGVkID0gdHJ1ZTtcblx0XHRcdGl0ZW0uc2VsZiA9IHRoaXM7XG5cdFx0XHRpdGVtLmFyZ3VtZW50cyA9IGFyZ3VtZW50cztcblx0XHRcdHdoaWxlICggcXVldWUubGVuZ3RoICYmIHF1ZXVlWzBdLmZpbmlzaGVkICkge1xuXHRcdFx0XHRpdCA9IHF1ZXVlLnNoaWZ0KCk7XG5cdFx0XHRcdGl0LmRvbmUuYXBwbHkoIGl0LnNlbGYsIGl0LmFyZ3VtZW50cyApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0fVxuXG5cblx0YXBpLkFjZkZpZWxkR3JvdXBDb250cm9sID0gYXBpLkNvbnRyb2wuZXh0ZW5kKHtcblx0XHRwcmV2aWV3X2NvbnRleHQ6IHtcblx0XHRcdHR5cGU6IG51bGwsXG5cdFx0XHRpZDogbnVsbCxcblx0XHR9LFxuXHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKCBpZCwgb3B0ICkge1xuXHRcdFx0dmFyIGNvbnRyb2wgPSB0aGlzLCBhcmdzO1xuXG4gICAgICAgICAgICBhcmdzID0gb3B0IHx8IHt9O1xuXG5cdFx0XHRhcGkuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKCBjb250cm9sLCBpZCwgYXJncyApO1xuXG5cdFx0fSxcblx0XHRzZXRfcHJldmlld19jb250ZXh0OiBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFx0XHR0aGlzLnByZXZpZXdfY29udGV4dCA9IGNvbnRleHQ7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlYWR5OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjb250cm9sID0gdGhpcyxcblx0XHRcdFx0c2V0dGluZ3MgPSB0aGlzLnNldHRpbmcoKTtcblxuXHRcdFx0aWYgKCAwIDw9IFsncG9zdCcsJ3Rlcm0nLCd1c2VyJ10uaW5kZXhPZiggY29udHJvbC5wYXJhbXMuc3RvcmFnZV90eXBlICkgKSB7XG5cdFx0XHRcdC8vIHJlbG9hZCBmaWVsZHMgaWYgcHJldmlldyB1cmwgY2hhbmdlZFxuXHRcdFx0XHRhcGkuYmluZCggJ2FjZi1jdXN0b21pemUtY29udGV4dC1jaGFuZ2VkJywgZnVuY3Rpb24oIGNvbnRleHQgKSB7XG5cblx0XHRcdFx0XHRpZiAoIGNvbnRleHQudHlwZSA9PT0gY29udHJvbC5wYXJhbXMuc3RvcmFnZV90eXBlICkge1xuXHRcdFx0XHRcdFx0Y29udHJvbFxuXHRcdFx0XHRcdFx0XHQuc2V0X3ByZXZpZXdfY29udGV4dCggY29udGV4dCApXG5cdFx0XHRcdFx0XHRcdC5sb2FkX2Zvcm0oKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29udHJvbC51bmxvYWRfZm9ybSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuJHdyYXBwZXIgPSBjb250cm9sLmNvbnRhaW5lci5maW5kKCcuYWNmLWZpZWxkcycpLmZpcnN0KCk7XG5cdFx0XHRhY2YuZG9fYWN0aW9uKCAnYXBwZW5kJywgY29udHJvbC5jb250YWluZXIgKTtcblxuXHRcdFx0Y29udHJvbC5sb2FkX2Zvcm0oKTtcblxuXHRcdFx0Y29udHJvbC5jb250YWluZXIub24oJ2NoYW5nZScsJy5hY2YtZmllbGQnLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0Ly8qXG5cdFx0XHRcdC8vIGNoZWNrIHZhbGlkXG5cdFx0XHRcdHZhciAkaW5wdXRzID0gY29udHJvbC5jb250YWluZXIuZmluZCgnLmFjZi1maWVsZCA6aW5wdXRbbmFtZV0nKTtcblxuXHRcdFx0XHRhY2YudmFsaWRhdGlvbi5lcnJvcnMgPSBbXTtcblx0XHRcdFx0JGlucHV0cy5lYWNoKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0dGhpcy5jaGVja1ZhbGlkaXR5KCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGFjZi52YWxpZGF0aW9uLmJ1c3kgPSBmYWxzZTtcblx0XHRcdFx0Y3VycmVudF9jb250cm9sID0gY29udHJvbDtcblxuXHRcdFx0XHQvLyByZXNldCB2YWxpZGF0aW9uIHN0YXR1c1xuXHRcdFx0XHQkKCBjb250cm9sLmNvbnRhaW5lciApLmRhdGEoJ2FjZicsbnVsbCk7XG5cblx0XHRcdFx0YWNmLnZhbGlkYXRpb24uZmV0Y2goIHtcblx0XHRcdFx0XHRmb3JtOiBjb250cm9sLmNvbnRhaW5lcixcblx0XHRcdFx0XHRsb2NrOmZhbHNlLFxuXHRcdFx0XHRcdHN1Y2Nlc3M6ZnVuY3Rpb24oJGZvcm0pIHtcblx0XHRcdFx0XHRcdC8vIGFsbG93IGZvciBzdWJtaXRcblx0XHRcdFx0XHRcdC8vIGFjZi52YWxpZGF0aW9uLmlnbm9yZSA9IDE7XG5cdFx0XHRcdFx0XHQvLyAkYnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdFx0fSxcblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH0pO1xuXG5cdFx0XHRhcGkuQ29udHJvbC5wcm90b3R5cGUucmVhZHkuYXBwbHkoIGNvbnRyb2wsIGFyZ3VtZW50cyApO1xuXG5cdFx0fSxcblx0XHRsb2FkX2Zvcm06IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgY29udHJvbCA9IHRoaXMsXG5cdFx0XHRcdHJlcXVlc3Q7XG5cblx0XHRcdHJlcXVlc3QgPSB3cC5hamF4LnNlbmQoICdsb2FkX2N1c3RvbWl6ZXJfZmllbGRfZ3JvdXBzXycrY29udHJvbC5pZCwge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0d3BfY3VzdG9taXplXHRcdFx0OiAnb24nLFxuXHRcdFx0XHRcdHNlY3Rpb25faWRcdFx0XHRcdDogY29udHJvbC5pZCxcblx0XHRcdFx0XHRhY2ZfY3VzdG9taXplX2NvbnRleHRcdDogSlNPTi5zdHJpbmdpZnkoIGNvbnRyb2wucHJldmlld19jb250ZXh0ICksXG5cdFx0XHRcdFx0X25vbmNlXHRcdFx0XHRcdDogb3B0aW9ucy5sb2FkX2ZpZWxkX2dyb3VwX25vbmNlLFxuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cblxuXHRcdFx0ZW5xdWV1ZSggcmVxdWVzdCwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuXHRcdFx0XHRjb250cm9sLiR3cmFwcGVyLmh0bWwoIHJlc3BvbnNlLmh0bWwgKTtcblxuXHRcdFx0XHRjb250cm9sLmluaXRfZmllbGRzKCk7XG5cblx0XHRcdH0gKTtcblx0XHRcdHJlcXVlc3QuZmFpbCggZnVuY3Rpb24oIHJlc3BvbnNlICkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnIC0gbG9hZCBmaWVsZCBncm91cCBmYWlsdXJlJylcblx0XHRcdH0gKTtcblxuXHRcdFx0cmVxdWVzdC5hbHdheXMoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXF1ZXN0ID0gbnVsbDtcblx0XHRcdH0gKTtcblxuXHRcdH0sXG5cdFx0dW5sb2FkX2Zvcm06IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGNvbnRyb2wgPSB0aGlzO1xuXG5cdFx0XHRjb250cm9sLiR3cmFwcGVyLmh0bWwoICcnICk7XG5cdFx0fSxcblx0XHRpbml0X2ZpZWxkczogZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBjb250cm9sID0gdGhpcztcblxuXHRcdFx0Y29udHJvbC4kZmllbGRzID0gY29udHJvbC5jb250YWluZXIuZmluZCgnLmFjZi1maWVsZHMgPiAuYWNmLWZpZWxkJyk7XG5cblx0XHRcdC8vIHdpbGwgaW5pdCBmaWVsZHNcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0YWNmLmRvQWN0aW9uKCdyZWFkeScsIGNvbnRyb2wuJHdyYXBwZXIpO1xuXHRcdFx0XHRhY2YuZG9BY3Rpb24oJ3ByZXBhcmUnKTtcblx0XHRcdH0sMSk7XG5cdFx0fSxcblx0XHR1cGRhdGVWYWx1ZXM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGNvbnRyb2wgPSB0aGlzLFxuXHRcdFx0XHQkaW5wdXRzID0gY29udHJvbC5jb250YWluZXIuZmluZCgnLmFjZi1maWVsZCA6aW5wdXQnKSxcblx0XHRcdFx0dmFsdWU7XG5cblx0XHRcdC8vIGNvbnZlcnQgb2JqZWN0IHdpdGggcHJlZml4ZWQgbnVtZXJpYyBrZXlzIHRvIGFycmF5XG5cdFx0XHRmdW5jdGlvbiBmaXhOdW1LZXlzKCBvYmogKSB7XG5cdFx0XHRcdGlmICggJC5pc1BsYWluT2JqZWN0KCBvYmogKSApIHtcblx0XHRcdFx0XHQvLyBjb252ZXJ0IG9iamVjdHMgd2l0aCBudW1lcmljIGtleXMgdG8gYXJyYXlcblx0XHRcdFx0XHRpZiAoIE9iamVjdC5rZXlzKCBvYmogKS5qb2luKCcnKS5tYXRjaCgvXihbMC05X10rKSQvKSApIHtcblx0XHRcdFx0XHRcdG9iaiA9IE9iamVjdC52YWx1ZXMoIG9iaiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyByZWN1cnNlXG5cdFx0XHRcdFx0JC5lYWNoKCBvYmosZnVuY3Rpb24oaSxlbCl7XG5cdFx0XHRcdFx0XHRvYmpbaV0gPSBmaXhOdW1LZXlzKCBlbCApO1xuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gb2JqO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBwcmVmaXggbnVtZXJpYyBrZXlzIHdpdGggYF9gXG5cdFx0XHQvLyByZXBlYXRlciBmaWVsZCBuYW1lcyBoYXZlIG51bWVyaWMga2V5cywgd2hpY2ggZ2V0IGF1dG9tYXRpY2FsbHkgc29ydGVkIHVwb24gc2VyaWFsaXphdGlvbi5cblx0XHRcdCRpbnB1dHMuZWFjaChmdW5jdGlvbigpe1xuXHRcdFx0XHR2YXIgbmFtZSA9ICQodGhpcykuYXR0cignbmFtZScpO1xuXG5cdFx0XHRcdGlmICggISBuYW1lICkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHQkKHRoaXMpLmRhdGEoJ3ByZXYtbmFtZScsIG5hbWUgKTtcblx0XHRcdFx0JCh0aGlzKS5hdHRyKCduYW1lJyxuYW1lLnJlcGxhY2UoIC9cXFsoWzAtOV0rKVxcXS9nLCAnXFxbXyQxXFxdJykpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHZhbHVlID0gJGlucHV0cy5zZXJpYWxpemVKU09OKHtcblx0XHRcdFx0dXNlSW50S2V5c0FzQXJyYXlJbmRleDpmYWxzZSxcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyAuLi4gcmVzdG9yaW5nIGZpZWxkIG5hbWVzIHRvIHByZXZpb3VzIHN0YXRlXG5cdFx0XHQkaW5wdXRzLmVhY2goZnVuY3Rpb24oKXtcblx0XHRcdFx0JCh0aGlzKS5hdHRyKCAnbmFtZScsICQodGhpcykuZGF0YSgncHJldi1uYW1lJykgKTtcblx0XHRcdFx0JCh0aGlzKS5kYXRhKCdwcmV2LW5hbWUnLCBudWxsICk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gdXBkYXRlIGN1c3RvbWllciB2YWx1ZVxuXHRcdFx0Y29udHJvbC5zZXR0aW5nLnNldCggZml4TnVtS2V5cyggdmFsdWVbdGhpcy5pZCBdICkgKTtcblx0XHR9XG5cdH0pO1xuXG5cdGFjZi5hZGRfYWN0aW9uKCd2YWxpZGF0aW9uX3N1Y2Nlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0Y3VycmVudF9jb250cm9sLnVwZGF0ZVZhbHVlcygpO1xuXHR9KTtcblx0YWNmLmFkZF9hY3Rpb24oJ3ZhbGlkYXRpb25fZmFpbHVyZScsZnVuY3Rpb24oZSl7XG5cdFx0Ly8gbmVlZCB0byByZW1vdmUgYWNmIG1lc3NhZ2UgYmVjYXVzZSBpdCBkaXNwbGF5cyBhIHdyb25nIG51bWJlciBvZiBpbnZhbGlkIGZpZWxkc1xuXHRcdGN1cnJlbnRfY29udHJvbC5jb250YWluZXIuZmluZCgnPiAuYWNmLWVycm9yLW1lc3NhZ2UnKS5yZW1vdmUoKTtcblx0fSk7XG5cdGFjZi5hZGRfYWN0aW9uKCdpbnZhbGlkJywgZnVuY3Rpb24oJGlucHV0KXtcblx0XHRhY2YudmFsaWRhdGlvbi5idXN5ID0gdHJ1ZTtcblx0fSk7XG5cblxuXG5cdGFwaS5iaW5kKCdyZWFkeScsZnVuY3Rpb24oKXtcblx0XHRhcGkucHJldmlld2VyLmJpbmQoICdhY2YtY3VzdG9taXplLWNvbnRleHQnLCBmdW5jdGlvbiggbmV3X3ZhbCApIHtcblx0XHRcdHZhciBwcmV2X3ZhbDtcblxuXHRcdFx0cHJldl92YWwgPSBhY2ZfY3VzdG9taXplX2NvbnRleHRcblx0XHRcdGlmICggSlNPTi5zdHJpbmdpZnkobmV3X3ZhbCkgIT0gSlNPTi5zdHJpbmdpZnkocHJldl92YWwpICkge1xuXHRcdFx0XHRhcGkudHJpZ2dlciggJ2FjZi1jdXN0b21pemUtY29udGV4dC1jaGFuZ2VkJywgbmV3X3ZhbCApXG5cdFx0XHR9XG5cdFx0XHRhY2ZfY3VzdG9taXplX2NvbnRleHQgPSBuZXdfdmFsO1xuXHRcdH0pO1xuXG5cdFx0YXBpLnByZXZpZXdlci5iaW5kKCAnZm9jdXMtY29udHJvbC1mb3Itc2V0dGluZycsIGZ1bmN0aW9uKCBzZXR0aW5nSWQgKSB7XG5cdFx0XHQvLyBnZXQgY2xpY2tlZCBmaWVsZCAuLi5cblx0XHR9KTtcblxuXHR9KTtcblxuXG5cdGFwaS5iaW5kKCAnc2F2ZS1yZXF1ZXN0LXBhcmFtcycsIGZ1bmN0aW9uKHF1ZXJ5KXtcblx0XHRfLmV4dGVuZCggcXVlcnksIHsnYWNmX2N1c3RvbWl6ZV9jb250ZXh0JyA6IEpTT04uc3RyaW5naWZ5KCBhY2ZfY3VzdG9taXplX2NvbnRleHQgKX0gKSA7XG5cdH0gKTtcblx0Ly9cblxuIFx0YXBpLmNvbnRyb2xDb25zdHJ1Y3RvclsnYWNmX2N1c3RvbWl6ZXInXSA9IGFwaS5BY2ZGaWVsZEdyb3VwQ29udHJvbDtcblxuXHRhcGkuYmluZCgnY2hhbmdlc2V0LWVycm9yJywgZnVuY3Rpb24oKXtcblx0XHQvL2NvbnNvbGUubG9nKGFyZ3VtZW50cylcblx0fSk7XG5cblxuXG59KSggd3AuY3VzdG9taXplLCBqUXVlcnksIGFjZl9maWVsZGdyb3VwX2NvbnRyb2wgKTtcbiJdfQ==

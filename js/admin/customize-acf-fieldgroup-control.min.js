!function(i,o,a){var c,n,r=[];i.AcfFieldGroupControl=i.Control.extend({preview_context:{type:null,id:null},initialize:function(e,t){var n;n=t||{},i.Control.prototype.initialize.call(this,e,n)},set_preview_context:function(e){return this.preview_context=e,this},ready:function(){var n=this;this.setting();0<=["post","term","user"].indexOf(n.params.storage_type)&&i.bind("acf-customize-context-changed",function(e){e.type===n.params.storage_type?n.set_preview_context(e).load_form():n.unload_form()}),this.$wrapper=n.container.find(".acf-fields").first(),acf.do_action("append",n.container),n.load_form(),n.container.on("change",".acf-field",function(e){var t=n.container.find(".acf-field :input[name]");acf.validation.errors=[],t.each(function(){this.checkValidity()}),acf.validation.busy=!1,o((c=n).container).data("acf",null),acf.validation.fetch({form:n.container,lock:!1,success:function(e){},complete:function(e){acf.unlockForm(e)}})}),i.Control.prototype.ready.apply(n,arguments)},load_form:function(){var e,t,n,i,o=this;e=wp.ajax.send("load_customizer_field_groups_"+o.id,{data:{wp_customize:"on",section_id:o.id,acf_customize_context:JSON.stringify(o.preview_context),_nonce:a.load_field_group_nonce}}),t=e,n=function(e){o.$wrapper.html(e.html),o.init_fields()},i={idx:r.length,request:t,done:n,finished:!1,scope:null,arguments:null},r.push(i),t.done(function(){var e;for(i.finished=!0,i.self=this,i.arguments=arguments;r.length&&r[0].finished;)(e=r.shift()).done.apply(e.self,e.arguments)}),e.fail(function(e){console.log(" - load field group failure")}),e.always(function(){e=null})},unload_form:function(){this.$wrapper.html("")},init_fields:function(){var e=this;e.$fields=e.container.find(".acf-fields > .acf-field"),setTimeout(function(){acf.doAction("ready",e.$wrapper),acf.doAction("prepare")},1)},updateValues:function(){var e,t=this.container.find(".acf-field :input");t.each(function(){var e=o(this).attr("name");e&&(o(this).data("prev-name",e),o(this).attr("name",e.replace(/\[([0-9]+)\]/g,"[_$1]")))}),e=t.serializeJSON({useIntKeysAsArrayIndex:!1}),t.each(function(){o(this).attr("name",o(this).data("prev-name")),o(this).data("prev-name",null)}),this.setting.set(function n(i){return o.isPlainObject(i)&&(Object.keys(i).join("").match(/^([0-9_]+)$/)&&(i=Object.values(i)),o.each(i,function(e,t){i[e]=n(t)})),i}(e[this.id]))},focusField:function(e){for(var t,n=this.$wrapper,i=[];e.length;)if(t=e.pop(),(n=_.isNumber(t)?(console.log(n.is('[data-type="flexible_content"]'),n.is('[data-type="repeater"]')),n.is('[data-type="flexible_content"]')?n.find("> .acf-input > .acf-flexible-content > .values").children(":not(.acf-clone)").eq(t):!!n.is('[data-type="repeater"]')&&(console.log(n.find("> .acf-input > .acf-repeater > .acf-table > tbody")),n.find("> .acf-input > .acf-repeater > .acf-table > tbody").children(":not(.acf-clone)").eq(t))):n.find('[data-key="'+t+'"]'))&&n.is("[data-id]")&&i.push(n),!n.length)return!1;return this.focus(),setTimeout(function(){i.length&&i.forEach(function(e){var t=acf.getField(e.closest(".acf-field"));e.siblings().not(e).each(function(){"repeater"===t.type?t.collapse(o(this)):"flexible_content"===t.type&&t.closeLayout(o(this))}),"repeater"===t.type?t.expand(e):"flexible_content"===t.type&&t.openLayout(e)}),_.isNumber(t)?n.attr("tabindex",1).focus():n.find("input").focus()},500),!0}}),acf.add_action("validation_success",function(e){c.updateValues()}),acf.add_action("validation_failure",function(e){c.container.find("> .acf-error-message").remove()}),acf.add_action("invalid",function(e){acf.validation.busy=!0}),i.bind("ready",function(){i.previewer.bind("acf-customize-context",function(e){var t;t=n,JSON.stringify(e)!=JSON.stringify(t)&&i.trigger("acf-customize-context-changed",e),n=e}),i.previewer.bind("focus-control-for-setting",function(e){}),i.previewer.bind("acf-focus",function(t){console.log(t);var n=t.pop();i.control.each(function(e){if(e.constructor===i.AcfFieldGroupControl)if(_.isNumber(n)){if(e.preview_context&&e.preview_context.id===n&&e.focusField(t))return}else if(e.id===n&&e.focusField(t))return})})}),i.bind("save-request-params",function(e){_.extend(e,{acf_customize_context:JSON.stringify(n)})}),i.controlConstructor.acf_customizer=i.AcfFieldGroupControl,i.bind("changeset-error",function(){})}(wp.customize,jQuery,acf_fieldgroup_control);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbWl6ZS1hY2YtZmllbGRncm91cC1jb250cm9sLmpzIl0sIm5hbWVzIjpbImFwaSIsIiQiLCJvcHRpb25zIiwiY3VycmVudF9jb250cm9sIiwiYWNmX2N1c3RvbWl6ZV9jb250ZXh0IiwicXVldWUiLCJBY2ZGaWVsZEdyb3VwQ29udHJvbCIsIkNvbnRyb2wiLCJleHRlbmQiLCJwcmV2aWV3X2NvbnRleHQiLCJ0eXBlIiwiaWQiLCJpbml0aWFsaXplIiwib3B0IiwiYXJncyIsInByb3RvdHlwZSIsImNhbGwiLCJ0aGlzIiwic2V0X3ByZXZpZXdfY29udGV4dCIsImNvbnRleHQiLCJyZWFkeSIsImNvbnRyb2wiLCJzZXR0aW5nIiwiaW5kZXhPZiIsInBhcmFtcyIsInN0b3JhZ2VfdHlwZSIsImJpbmQiLCJsb2FkX2Zvcm0iLCJ1bmxvYWRfZm9ybSIsIiR3cmFwcGVyIiwiY29udGFpbmVyIiwiZmluZCIsImZpcnN0IiwiYWNmIiwiZG9fYWN0aW9uIiwib24iLCJlIiwiJGlucHV0cyIsInZhbGlkYXRpb24iLCJlcnJvcnMiLCJlYWNoIiwiY2hlY2tWYWxpZGl0eSIsImJ1c3kiLCJkYXRhIiwiZmV0Y2giLCJmb3JtIiwibG9jayIsInN1Y2Nlc3MiLCIkZm9ybSIsImNvbXBsZXRlIiwidW5sb2NrRm9ybSIsImFwcGx5IiwiYXJndW1lbnRzIiwicmVxdWVzdCIsImRvbmUiLCJpdGVtIiwid3AiLCJhamF4Iiwic2VuZCIsIndwX2N1c3RvbWl6ZSIsInNlY3Rpb25faWQiLCJKU09OIiwic3RyaW5naWZ5IiwiX25vbmNlIiwibG9hZF9maWVsZF9ncm91cF9ub25jZSIsInJlc3BvbnNlIiwiaHRtbCIsImluaXRfZmllbGRzIiwiaWR4IiwibGVuZ3RoIiwiZmluaXNoZWQiLCJzY29wZSIsInB1c2giLCJpdCIsInNlbGYiLCJzaGlmdCIsImZhaWwiLCJjb25zb2xlIiwibG9nIiwiYWx3YXlzIiwiJGZpZWxkcyIsInNldFRpbWVvdXQiLCJkb0FjdGlvbiIsInVwZGF0ZVZhbHVlcyIsInZhbHVlIiwibmFtZSIsImF0dHIiLCJyZXBsYWNlIiwic2VyaWFsaXplSlNPTiIsInVzZUludEtleXNBc0FycmF5SW5kZXgiLCJzZXQiLCJmaXhOdW1LZXlzIiwib2JqIiwiaXNQbGFpbk9iamVjdCIsIk9iamVjdCIsImtleXMiLCJqb2luIiwibWF0Y2giLCJ2YWx1ZXMiLCJpIiwiZWwiLCJmb2N1c0ZpZWxkIiwicGF0aCIsImN1cnJlbnQiLCIkZm9jdXNFbCIsImV4cGFuZCIsInBvcCIsIl8iLCJpc051bWJlciIsImlzIiwiY2hpbGRyZW4iLCJlcSIsImZvY3VzIiwiZm9yRWFjaCIsIiRyb3ciLCJmaWVsZCIsImdldEZpZWxkIiwiY2xvc2VzdCIsInNpYmxpbmdzIiwibm90IiwiY29sbGFwc2UiLCJjbG9zZUxheW91dCIsIm9wZW5MYXlvdXQiLCJhZGRfYWN0aW9uIiwicmVtb3ZlIiwiJGlucHV0IiwicHJldmlld2VyIiwibmV3X3ZhbCIsInByZXZfdmFsIiwidHJpZ2dlciIsInNldHRpbmdJZCIsInBvc3RfaWQiLCJjb25zdHJ1Y3RvciIsInF1ZXJ5IiwiY29udHJvbENvbnN0cnVjdG9yIiwiY3VzdG9taXplIiwialF1ZXJ5IiwiYWNmX2ZpZWxkZ3JvdXBfY29udHJvbCJdLCJtYXBwaW5ncyI6IkNBQ0EsU0FBV0EsRUFBS0MsRUFBR0MsR0FHbEIsSUFBSUMsRUFDSEMsRUFDQUMsRUFBUSxHQTRDVEwsRUFBSU0scUJBQXVCTixFQUFJTyxRQUFRQyxPQUFPLENBQzdDQyxnQkFBaUIsQ0FDaEJDLEtBQU0sS0FDTkMsR0FBSSxNQUVMQyxXQUFZLFNBQVVELEVBQUlFLEdBQ3pCLElBQW9CQyxFQUVYQSxFQUFPRCxHQUFPLEdBRXZCYixFQUFJTyxRQUFRUSxVQUFVSCxXQUFXSSxLQUpuQkMsS0FJa0NOLEVBQUlHLElBR3JESSxvQkFBcUIsU0FBU0MsR0FFN0IsT0FEQUYsS0FBS1IsZ0JBQWtCVSxFQUNoQkYsTUFFUkcsTUFBTyxXQUNOLElBQUlDLEVBQVVKLEtBQ0ZBLEtBQUtLLFVBRVos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RUFBRW5HLE9BQVE2SCxFQUFPLENBQUNqSSxzQkFBMEJ5RCxLQUFLQyxVQUFXMUQsT0FJNURKLEVBQUlzSSxtQkFBbUMsZUFBSXRJLEVBQUlNLHFCQUVoRE4sRUFBSTBCLEtBQUssa0JBQW1CLGNBcFU3QixDQTBVSThCLEdBQUcrRSxVQUFXQyxPQUFRQyIsImZpbGUiOiJjdXN0b21pemUtYWNmLWZpZWxkZ3JvdXAtY29udHJvbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbihmdW5jdGlvbiggYXBpLCAkLCBvcHRpb25zICkge1xuXG5cdC8vIHN0b3JlIGZvciBhY2YncyBzdGF0aWMgdmFsaWRhdGlvbiBjYWxsYmFja3Ncblx0dmFyIGN1cnJlbnRfY29udHJvbCxcblx0XHRhY2ZfY3VzdG9taXplX2NvbnRleHQsXG5cdFx0cXVldWUgPSBbXTtcblxuXHQvLyBtYWtlIHN1cmUgZmllbGRzIGdldCBpbml0ZWQgaW4gdGhlIG9yZGVyIHRoZXkgYXBwZWFyIGluIHRoZSBkb21cblx0ZnVuY3Rpb24gZW5xdWV1ZShyZXF1ZXN0LGRvbmUpIHtcblx0XHR2YXIgaWR4ID0gcXVldWUubGVuZ3RoLFxuXHRcdFx0aXRlbSA9IHsgaWR4OmlkeCwgcmVxdWVzdDpyZXF1ZXN0LCBkb25lOiBkb25lLCBmaW5pc2hlZDpmYWxzZSwgc2NvcGU6bnVsbCwgYXJndW1lbnRzOm51bGwgfTtcblxuXHRcdHF1ZXVlLnB1c2goIGl0ZW0gKTtcblxuXHRcdHJlcXVlc3QuZG9uZSggZnVuY3Rpb24oKXtcblx0XHRcdHZhciBpdDtcblx0XHRcdGl0ZW0uZmluaXNoZWQgPSB0cnVlO1xuXHRcdFx0aXRlbS5zZWxmID0gdGhpcztcblx0XHRcdGl0ZW0uYXJndW1lbnRzID0gYXJndW1lbnRzO1xuXHRcdFx0d2hpbGUgKCBxdWV1ZS5sZW5ndGggJiYgcXVldWVbMF0uZmluaXNoZWQgKSB7XG5cdFx0XHRcdGl0ID0gcXVldWUuc2hpZnQoKTtcblx0XHRcdFx0aXQuZG9uZS5hcHBseSggaXQuc2VsZiwgaXQuYXJndW1lbnRzICk7XG5cdFx0XHR9XG5cdFx0fSApO1xuXHR9XG5cblxuXHRmdW5jdGlvbiBleHBhbmRSZXBlYXRhYmxlcyggZXhwYW5kICkge1xuXHRcdHJldHVybiBleHBhbmQuZm9yRWFjaChmdW5jdGlvbigkcm93KXtcblx0XHRcdHZhciBmaWVsZCA9IGFjZi5nZXRGaWVsZCggJHJvdy5jbG9zZXN0KCcuYWNmLWZpZWxkJykgKTtcblx0XHRcdC8vIGNvbGxhcHNlIG90aGVyc1xuXHRcdFx0JHJvdy5zaWJsaW5ncygpLm5vdCgkcm93KS5lYWNoKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGlmICggZmllbGQudHlwZSA9PT0gJ3JlcGVhdGVyJyApIHtcblx0XHRcdFx0XHRmaWVsZC5jb2xsYXBzZSgkKHRoaXMpKTtcblx0XHRcdFx0fSBlbHNlIGlmICggZmllbGQudHlwZSA9PT0gJ2ZsZXhpYmxlX2NvbnRlbnQnICkge1xuXHRcdFx0XHRcdGZpZWxkLmNsb3NlTGF5b3V0KCQodGhpcykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKCBmaWVsZC50eXBlID09PSAncmVwZWF0ZXInICkge1xuXHRcdFx0XHRmaWVsZC5leHBhbmQoJHJvdyk7XG5cdFx0XHR9IGVsc2UgaWYgKCBmaWVsZC50eXBlID09PSAnZmxleGlibGVfY29udGVudCcgKSB7XG5cdFx0XHRcdGZpZWxkLm9wZW5MYXlvdXQoJHJvdyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0fVxuXG5cblx0YXBpLkFjZkZpZWxkR3JvdXBDb250cm9sID0gYXBpLkNvbnRyb2wuZXh0ZW5kKHtcblx0XHRwcmV2aWV3X2NvbnRleHQ6IHtcblx0XHRcdHR5cGU6IG51bGwsXG5cdFx0XHRpZDogbnVsbCxcblx0XHR9LFxuXHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKCBpZCwgb3B0ICkge1xuXHRcdFx0dmFyIGNvbnRyb2wgPSB0aGlzLCBhcmdzO1xuXG4gICAgICAgICAgICBhcmdzID0gb3B0IHx8IHt9O1xuXG5cdFx0XHRhcGkuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKCBjb250cm9sLCBpZCwgYXJncyApO1xuXG5cdFx0fSxcblx0XHRzZXRfcHJldmlld19jb250ZXh0OiBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFx0XHR0aGlzLnByZXZpZXdfY29udGV4dCA9IGNvbnRleHQ7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdHJlYWR5OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBjb250cm9sID0gdGhpcyxcblx0XHRcdFx0c2V0dGluZ3MgPSB0aGlzLnNldHRpbmcoKTtcblxuXHRcdFx0aWYgKCAwIDw9IFsncG9zdCcsJ3Rlcm0nLCd1c2VyJ10uaW5kZXhPZiggY29udHJvbC5wYXJhbXMuc3RvcmFnZV90eXBlICkgKSB7XG5cdFx0XHRcdC8vIHJlbG9hZCBmaWVsZHMgaWYgcHJldmlldyB1cmwgY2hhbmdlZFxuXHRcdFx0XHRhcGkuYmluZCggJ2FjZi1jdXN0b21pemUtY29udGV4dC1jaGFuZ2VkJywgZnVuY3Rpb24oIGNvbnRleHQgKSB7XG5cblx0XHRcdFx0XHRpZiAoIGNvbnRleHQudHlwZSA9PT0gY29udHJvbC5wYXJhbXMuc3RvcmFnZV90eXBlICkge1xuXHRcdFx0XHRcdFx0Y29udHJvbFxuXHRcdFx0XHRcdFx0XHQuc2V0X3ByZXZpZXdfY29udGV4dCggY29udGV4dCApXG5cdFx0XHRcdFx0XHRcdC5sb2FkX2Zvcm0oKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29udHJvbC51bmxvYWRfZm9ybSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuJHdyYXBwZXIgPSBjb250cm9sLmNvbnRhaW5lci5maW5kKCcuYWNmLWZpZWxkcycpLmZpcnN0KCk7XG5cdFx0XHRhY2YuZG9fYWN0aW9uKCAnYXBwZW5kJywgY29udHJvbC5jb250YWluZXIgKTtcblxuXHRcdFx0Y29udHJvbC5sb2FkX2Zvcm0oKTtcblxuXHRcdFx0Y29udHJvbC5jb250YWluZXIub24oJ2NoYW5nZScsJy5hY2YtZmllbGQnLCBmdW5jdGlvbihlKXtcblx0XHRcdFx0Ly8qXG5cdFx0XHRcdC8vIGNoZWNrIHZhbGlkXG5cdFx0XHRcdHZhciAkaW5wdXRzID0gY29udHJvbC5jb250YWluZXIuZmluZCgnLmFjZi1maWVsZCA6aW5wdXRbbmFtZV0nKTtcblxuXHRcdFx0XHRhY2YudmFsaWRhdGlvbi5lcnJvcnMgPSBbXTtcblx0XHRcdFx0JGlucHV0cy5lYWNoKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0dGhpcy5jaGVja1ZhbGlkaXR5KCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGFjZi52YWxpZGF0aW9uLmJ1c3kgPSBmYWxzZTtcblx0XHRcdFx0Y3VycmVudF9jb250cm9sID0gY29udHJvbDtcblxuXHRcdFx0XHQvLyByZXNldCB2YWxpZGF0aW9uIHN0YXR1c1xuXHRcdFx0XHQkKCBjb250cm9sLmNvbnRhaW5lciApLmRhdGEoJ2FjZicsbnVsbCk7XG5cblx0XHRcdFx0YWNmLnZhbGlkYXRpb24uZmV0Y2goIHtcblx0XHRcdFx0XHRmb3JtOiBjb250cm9sLmNvbnRhaW5lcixcblx0XHRcdFx0XHRsb2NrOmZhbHNlLFxuXHRcdFx0XHRcdHN1Y2Nlc3M6ZnVuY3Rpb24oJGZvcm0pIHtcblx0XHRcdFx0XHRcdC8vIGFsbG93IGZvciBzdWJtaXRcblx0XHRcdFx0XHRcdC8vIGFjZi52YWxpZGF0aW9uLmlnbm9yZSA9IDE7XG5cdFx0XHRcdFx0XHQvLyAkYnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRjb21wbGV0ZTpmdW5jdGlvbigkZm9ybSkge1xuXHRcdFx0XHRcdFx0YWNmLnVubG9ja0Zvcm0oICRmb3JtICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH0pO1xuXG5cdFx0XHRhcGkuQ29udHJvbC5wcm90b3R5cGUucmVhZHkuYXBwbHkoIGNvbnRyb2wsIGFyZ3VtZW50cyApO1xuXG5cdFx0fSxcblx0XHRsb2FkX2Zvcm06IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgY29udHJvbCA9IHRoaXMsXG5cdFx0XHRcdHJlcXVlc3Q7XG5cblx0XHRcdHJlcXVlc3QgPSB3cC5hamF4LnNlbmQoICdsb2FkX2N1c3RvbWl6ZXJfZmllbGRfZ3JvdXBzXycgKyBjb250cm9sLmlkLCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHR3cF9jdXN0b21pemVcdFx0XHQ6ICdvbicsXG5cdFx0XHRcdFx0c2VjdGlvbl9pZFx0XHRcdFx0OiBjb250cm9sLmlkLFxuXHRcdFx0XHRcdGFjZl9jdXN0b21pemVfY29udGV4dFx0OiBKU09OLnN0cmluZ2lmeSggY29udHJvbC5wcmV2aWV3X2NvbnRleHQgKSxcblx0XHRcdFx0XHRfbm9uY2VcdFx0XHRcdFx0OiBvcHRpb25zLmxvYWRfZmllbGRfZ3JvdXBfbm9uY2UsXG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblxuXG5cdFx0XHRlbnF1ZXVlKCByZXF1ZXN0LCBmdW5jdGlvbihyZXNwb25zZSkge1xuXG5cdFx0XHRcdGNvbnRyb2wuJHdyYXBwZXIuaHRtbCggcmVzcG9uc2UuaHRtbCApO1xuXG5cdFx0XHRcdGNvbnRyb2wuaW5pdF9maWVsZHMoKTtcblxuXHRcdFx0fSApO1xuXHRcdFx0cmVxdWVzdC5mYWlsKCBmdW5jdGlvbiggcmVzcG9uc2UgKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCcgLSBsb2FkIGZpZWxkIGdyb3VwIGZhaWx1cmUnKVxuXHRcdFx0fSApO1xuXG5cdFx0XHRyZXF1ZXN0LmFsd2F5cyggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJlcXVlc3QgPSBudWxsO1xuXHRcdFx0fSApO1xuXG5cdFx0fSxcblx0XHR1bmxvYWRfZm9ybTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgY29udHJvbCA9IHRoaXM7XG5cblx0XHRcdGNvbnRyb2wuJHdyYXBwZXIuaHRtbCggJycgKTtcblx0XHR9LFxuXHRcdGluaXRfZmllbGRzOiBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIGNvbnRyb2wgPSB0aGlzO1xuXG5cdFx0XHRjb250cm9sLiRmaWVsZHMgPSBjb250cm9sLmNvbnRhaW5lci5maW5kKCcuYWNmLWZpZWxkcyA+IC5hY2YtZmllbGQnKTtcblxuXHRcdFx0Ly8gd2lsbCBpbml0IGZpZWxkc1xuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRhY2YuZG9BY3Rpb24oJ3JlYWR5JywgY29udHJvbC4kd3JhcHBlcik7XG5cdFx0XHRcdGFjZi5kb0FjdGlvbigncHJlcGFyZScpO1xuXHRcdFx0fSwxKTtcblx0XHR9LFxuXHRcdHVwZGF0ZVZhbHVlczogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgY29udHJvbCA9IHRoaXMsXG5cdFx0XHRcdCRpbnB1dHMgPSBjb250cm9sLmNvbnRhaW5lci5maW5kKCcuYWNmLWZpZWxkIDppbnB1dCcpLFxuXHRcdFx0XHR2YWx1ZTtcblxuXHRcdFx0Ly8gY29udmVydCBvYmplY3Qgd2l0aCBwcmVmaXhlZCBudW1lcmljIGtleXMgdG8gYXJyYXlcblx0XHRcdGZ1bmN0aW9uIGZpeE51bUtleXMoIG9iaiApIHtcblx0XHRcdFx0aWYgKCAkLmlzUGxhaW5PYmplY3QoIG9iaiApICkge1xuXHRcdFx0XHRcdC8vIGNvbnZlcnQgb2JqZWN0cyB3aXRoIG51bWVyaWMga2V5cyB0byBhcnJheVxuXHRcdFx0XHRcdGlmICggT2JqZWN0LmtleXMoIG9iaiApLmpvaW4oJycpLm1hdGNoKC9eKFswLTlfXSspJC8pICkge1xuXHRcdFx0XHRcdFx0b2JqID0gT2JqZWN0LnZhbHVlcyggb2JqICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIHJlY3Vyc2Vcblx0XHRcdFx0XHQkLmVhY2goIG9iaixmdW5jdGlvbihpLGVsKXtcblx0XHRcdFx0XHRcdG9ialtpXSA9IGZpeE51bUtleXMoIGVsICk7XG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBvYmo7XG5cdFx0XHR9XG5cblx0XHRcdC8vIHByZWZpeCBudW1lcmljIGtleXMgd2l0aCBgX2Bcblx0XHRcdC8vIHJlcGVhdGVyIGZpZWxkIG5hbWVzIGhhdmUgbnVtZXJpYyBrZXlzLCB3aGljaCBnZXQgYXV0b21hdGljYWxseSBzb3J0ZWQgdXBvbiBzZXJpYWxpemF0aW9uLlxuXHRcdFx0JGlucHV0cy5lYWNoKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciBuYW1lID0gJCh0aGlzKS5hdHRyKCduYW1lJyk7XG5cblx0XHRcdFx0aWYgKCAhIG5hbWUgKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQodGhpcykuZGF0YSgncHJldi1uYW1lJywgbmFtZSApO1xuXHRcdFx0XHQkKHRoaXMpLmF0dHIoJ25hbWUnLG5hbWUucmVwbGFjZSggL1xcWyhbMC05XSspXFxdL2csICdcXFtfJDFcXF0nKSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dmFsdWUgPSAkaW5wdXRzLnNlcmlhbGl6ZUpTT04oe1xuXHRcdFx0XHR1c2VJbnRLZXlzQXNBcnJheUluZGV4OmZhbHNlLFxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIC4uLiByZXN0b3JpbmcgZmllbGQgbmFtZXMgdG8gcHJldmlvdXMgc3RhdGVcblx0XHRcdCRpbnB1dHMuZWFjaChmdW5jdGlvbigpe1xuXHRcdFx0XHQkKHRoaXMpLmF0dHIoICduYW1lJywgJCh0aGlzKS5kYXRhKCdwcmV2LW5hbWUnKSApO1xuXHRcdFx0XHQkKHRoaXMpLmRhdGEoJ3ByZXYtbmFtZScsIG51bGwgKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyB1cGRhdGUgY3VzdG9taWVyIHZhbHVlXG5cdFx0XHRjb250cm9sLnNldHRpbmcuc2V0KCBmaXhOdW1LZXlzKCB2YWx1ZVt0aGlzLmlkIF0gKSApO1xuXHRcdH0sXG5cdFx0Zm9jdXNGaWVsZDpmdW5jdGlvbiggcGF0aCApIHtcblx0XHRcdHZhciBjdXJyZW50LCBzZWxlY3RvciwgJGZvY3VzRWwgPSB0aGlzLiR3cmFwcGVyLCBleHBhbmQgPSBbXTtcblxuXHRcdFx0d2hpbGUgKCBwYXRoLmxlbmd0aCApIHtcblx0XHRcdFx0Y3VycmVudCA9IHBhdGgucG9wKCk7XG5cdFx0XHRcdGlmICggXy5pc051bWJlciggY3VycmVudCApICkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCRmb2N1c0VsLmlzKCdbZGF0YS10eXBlPVwiZmxleGlibGVfY29udGVudFwiXScpLCRmb2N1c0VsLmlzKCdbZGF0YS10eXBlPVwicmVwZWF0ZXJcIl0nKSlcblx0XHRcdFx0XHRpZiAoICRmb2N1c0VsLmlzKCdbZGF0YS10eXBlPVwiZmxleGlibGVfY29udGVudFwiXScpICkge1xuXHRcdFx0XHRcdFx0JGZvY3VzRWwgPSAkZm9jdXNFbC5maW5kKCc+IC5hY2YtaW5wdXQgPiAuYWNmLWZsZXhpYmxlLWNvbnRlbnQgPiAudmFsdWVzJykuY2hpbGRyZW4oJzpub3QoLmFjZi1jbG9uZSknKS5lcShjdXJyZW50KTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCAkZm9jdXNFbC5pcygnW2RhdGEtdHlwZT1cInJlcGVhdGVyXCJdJykgKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygkZm9jdXNFbC5maW5kKCc+IC5hY2YtaW5wdXQgPiAuYWNmLXJlcGVhdGVyID4gLmFjZi10YWJsZSA+IHRib2R5JykpO1xuXHRcdFx0XHRcdFx0JGZvY3VzRWwgPSAkZm9jdXNFbC5maW5kKCc+IC5hY2YtaW5wdXQgPiAuYWNmLXJlcGVhdGVyID4gLmFjZi10YWJsZSA+IHRib2R5JykuY2hpbGRyZW4oJzpub3QoLmFjZi1jbG9uZSknKS5lcShjdXJyZW50KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0JGZvY3VzRWwgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JGZvY3VzRWwgPSAkZm9jdXNFbC5maW5kKCdbZGF0YS1rZXk9XCInK2N1cnJlbnQrJ1wiXScpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggISEgJGZvY3VzRWwgJiYgJGZvY3VzRWwuaXMoJ1tkYXRhLWlkXScpICkge1xuXHRcdFx0XHRcdGV4cGFuZC5wdXNoKCAkZm9jdXNFbCApXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCAhICRmb2N1c0VsLmxlbmd0aCApIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gZm9jdXMgY29udHJvbFxuXHRcdFx0dGhpcy5mb2N1cygpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdC8vIGV4cGFuZCByZXBlYXRhYmxlLCBjb2xsYXBzZSBvdGhlcnNcblx0XHRcdFx0aWYgKCBleHBhbmQubGVuZ3RoICkge1xuXHRcdFx0XHRcdGV4cGFuZFJlcGVhdGFibGVzKCBleHBhbmQgKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0aWYgKCAhIF8uaXNOdW1iZXIoIGN1cnJlbnQgKSApIHtcblx0XHRcdFx0XHQvLyBmb2N1cyBpbnB1dCAuLlxuXHRcdFx0XHRcdCRmb2N1c0VsLmZpbmQoJ2lucHV0JykuZm9jdXMoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyAuLi4gb3IgZm9jdXMgcmVwZWF0YWJsZVxuXHRcdFx0XHRcdCRmb2N1c0VsLmF0dHIoJ3RhYmluZGV4JywxKS5mb2N1cygpXG5cdFx0XHRcdH1cblx0XHRcdH0sNTAwKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fSk7XG5cblx0YWNmLmFkZF9hY3Rpb24oJ3ZhbGlkYXRpb25fc3VjY2VzcycsIGZ1bmN0aW9uKGUpIHtcblx0XHRjdXJyZW50X2NvbnRyb2wudXBkYXRlVmFsdWVzKCk7XG5cdH0pO1xuXHRhY2YuYWRkX2FjdGlvbigndmFsaWRhdGlvbl9mYWlsdXJlJyxmdW5jdGlvbihlKXtcblx0XHQvLyBuZWVkIHRvIHJlbW92ZSBhY2YgbWVzc2FnZSBiZWNhdXNlIGl0IGRpc3BsYXlzIGEgd3JvbmcgbnVtYmVyIG9mIGludmFsaWQgZmllbGRzXG5cdFx0Y3VycmVudF9jb250cm9sLmNvbnRhaW5lci5maW5kKCc+IC5hY2YtZXJyb3ItbWVzc2FnZScpLnJlbW92ZSgpO1xuXHR9KTtcblx0YWNmLmFkZF9hY3Rpb24oJ2ludmFsaWQnLCBmdW5jdGlvbigkaW5wdXQpe1xuXHRcdGFjZi52YWxpZGF0aW9uLmJ1c3kgPSB0cnVlO1xuXHR9KTtcblxuXG5cblx0YXBpLmJpbmQoJ3JlYWR5JyxmdW5jdGlvbigpe1xuXHRcdGFwaS5wcmV2aWV3ZXIuYmluZCggJ2FjZi1jdXN0b21pemUtY29udGV4dCcsIGZ1bmN0aW9uKCBuZXdfdmFsICkge1xuXHRcdFx0dmFyIHByZXZfdmFsO1xuXG5cdFx0XHRwcmV2X3ZhbCA9IGFjZl9jdXN0b21pemVfY29udGV4dFxuXHRcdFx0aWYgKCBKU09OLnN0cmluZ2lmeShuZXdfdmFsKSAhPSBKU09OLnN0cmluZ2lmeShwcmV2X3ZhbCkgKSB7XG5cdFx0XHRcdGFwaS50cmlnZ2VyKCAnYWNmLWN1c3RvbWl6ZS1jb250ZXh0LWNoYW5nZWQnLCBuZXdfdmFsIClcblx0XHRcdH1cblx0XHRcdGFjZl9jdXN0b21pemVfY29udGV4dCA9IG5ld192YWw7XG5cdFx0fSk7XG5cblx0XHRhcGkucHJldmlld2VyLmJpbmQoICdmb2N1cy1jb250cm9sLWZvci1zZXR0aW5nJywgZnVuY3Rpb24oIHNldHRpbmdJZCApIHtcblx0XHRcdC8vIGdldCBjbGlja2VkIGZpZWxkIC4uLlxuXHRcdH0pO1xuXG5cblx0XHRhcGkucHJldmlld2VyLmJpbmQoICdhY2YtZm9jdXMnLCBmdW5jdGlvbiggcGF0aCApIHtcblx0XHRcdGNvbnNvbGUubG9nKHBhdGgpO1xuXHRcdFx0dmFyIHBvc3RfaWQgPSBwYXRoLnBvcCgpO1xuXHRcdFx0YXBpLmNvbnRyb2wuZWFjaCggZnVuY3Rpb24oIGNvbnRyb2wgKSB7XG5cdFx0XHRcdGlmICggY29udHJvbC5jb25zdHJ1Y3Rvcj09PWFwaS5BY2ZGaWVsZEdyb3VwQ29udHJvbCApIHtcblx0XHRcdFx0XHRpZiAoIF8uaXNOdW1iZXIoIHBvc3RfaWQgKSApIHtcblx0XHRcdFx0XHRcdGlmICggISEgY29udHJvbC5wcmV2aWV3X2NvbnRleHQgJiYgKCBjb250cm9sLnByZXZpZXdfY29udGV4dC5pZCA9PT0gcG9zdF9pZCApICkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIGNvbnRyb2wuZm9jdXNGaWVsZCggcGF0aCApICkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoIGNvbnRyb2wuaWQgPT09IHBvc3RfaWQgJiYgY29udHJvbC5mb2N1c0ZpZWxkKCBwYXRoICkgKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdH0pO1xuXG5cblx0YXBpLmJpbmQoICdzYXZlLXJlcXVlc3QtcGFyYW1zJywgZnVuY3Rpb24ocXVlcnkpe1xuXHRcdF8uZXh0ZW5kKCBxdWVyeSwgeydhY2ZfY3VzdG9taXplX2NvbnRleHQnIDogSlNPTi5zdHJpbmdpZnkoIGFjZl9jdXN0b21pemVfY29udGV4dCApfSApIDtcblx0fSApO1xuXHQvL1xuXG4gXHRhcGkuY29udHJvbENvbnN0cnVjdG9yWydhY2ZfY3VzdG9taXplciddID0gYXBpLkFjZkZpZWxkR3JvdXBDb250cm9sO1xuXG5cdGFwaS5iaW5kKCdjaGFuZ2VzZXQtZXJyb3InLCBmdW5jdGlvbigpe1xuXHRcdC8vY29uc29sZS5sb2coYXJndW1lbnRzKVxuXHR9KTtcblxuXG5cbn0pKCB3cC5jdXN0b21pemUsIGpRdWVyeSwgYWNmX2ZpZWxkZ3JvdXBfY29udHJvbCApO1xuIl19
